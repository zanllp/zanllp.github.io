(function(){var e={4128:function(e,t,o){e.exports=o.p+"290feb9fd69f68e66efa261311465406.vrm"},7993:function(e,t,o){e.exports=o.p+"0cd5ecf8f6947cc6f087311ab0e32d85.fbx"},8768:function(e,t,o){"use strict";var i=o(3862),n=o(3396),r=o(5431),a=o(5941);(0,r.z)("/service-worker.js",{ready(){a.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){a.log("Service worker has been registered.")},cached(){a.log("Content has been cached for offline use.")},updatefound(){a.log("New content is downloading.")},updated(){a.log("New content is available; please refresh.")},offline(){a.log("No internet connection found. App is running in offline mode.")},error(e){a.error("Error during service worker registration:",e)}});var s=o(1114),d=o(4198),m=o(8371),l=o(4543),c=o(9653),u=o(5461),f=o(4128),h=o.n(f),g=o(6573);const p=[m.wZ.HumanoidBoneName.Head,m.wZ.HumanoidBoneName.Neck,m.wZ.HumanoidBoneName.Chest,m.wZ.HumanoidBoneName.Spine,m.wZ.HumanoidBoneName.Hips,m.wZ.HumanoidBoneName.RightShoulder,m.wZ.HumanoidBoneName.RightUpperArm,m.wZ.HumanoidBoneName.RightLowerArm,m.wZ.HumanoidBoneName.RightHand,m.wZ.HumanoidBoneName.LeftShoulder,m.wZ.HumanoidBoneName.LeftUpperArm,m.wZ.HumanoidBoneName.LeftLowerArm,m.wZ.HumanoidBoneName.LeftHand,m.wZ.HumanoidBoneName.RightUpperLeg,m.wZ.HumanoidBoneName.RightLowerLeg,m.wZ.HumanoidBoneName.RightFoot,m.wZ.HumanoidBoneName.LeftUpperLeg,m.wZ.HumanoidBoneName.LeftLowerLeg,m.wZ.HumanoidBoneName.LeftFoot],w=["mixamorigHead","mixamorigNeck","mixamorigSpine2","mixamorigSpine","mixamorigHips","mixamorigRightShoulder","mixamorigRightArm","mixamorigRightForeArm","mixamorigRightHand","mixamorigLeftShoulder","mixamorigLeftArm","mixamorigLeftForeArm","mixamorigLeftHand","mixamorigRightUpLeg","mixamorigRightLeg","mixamorigRightFoot","mixamorigLeftUpLeg","mixamorigLeftLeg","mixamorigLeftFoot"];function v(e,t){for(let o=0;o<t.length;o++)if(t[o].name===e)return t[o];return null}var x;function y(e,t,o=!0){const i=e.tracks,n=p.map((e=>t.humanoid.getBoneNode(e))),r=[];for(const s of w){const e=v(`${s}.position`,i),t=v(`${s}.quaternion`,i),n=[],a=.008;if(null!==t)for(let i=0;i<t.times.length;i++){const r={};r.time=parseInt(""+1e3*t.times[i]),r.rot=[-t.values[4*i],t.values[4*i+1],-t.values[4*i+2],t.values[4*i+3]],"mixamorigHips"===s&&null!==e&&o&&(r.pos=[-e.values[3*i]*a,e.values[3*i+1]*a,-e.values[3*i+2]*a]),n.push(r)}n.length>0&&r.push({keys:n})}const a=s.m7l.parseAnimation({hierarchy:r},n);return a.tracks.forEach((e=>{e.name=e.name.replace(/^\.bones\[([^\]]+)\].(position|quaternion|scale)$/,"$1.$2")})),a}(function(e){e[e["BvhWebViewr"]=0]="BvhWebViewr",e[e["Tdpt"]=1]="Tdpt"})(x||(x={}));var b,L=o(2482);(function(e){e[e["Right"]=0]="Right",e[e["Left"]=1]="Left",e[e["None"]=2]="None"})(b||(b={}));class A{constructor(e,t=null){(0,L.Z)(this,"vrm",void 0),(0,L.Z)(this,"forwardFlug",!1),(0,L.Z)(this,"forwardAnimation",null),(0,L.Z)(this,"turnDirection",b.None),this.vrm=e,this.forwardAnimation=t}get forwardVector(){const e={x:-Math.sin(this.vrm.scene.rotation.y),z:-Math.cos(this.vrm.scene.rotation.y)};return e}forwardUpdate(e=.025){if(this.forwardFlug){const t=this.forwardVector,o=t.x*e,i=t.z*e;this.vrm.scene.position.x+=o,this.vrm.scene.position.z+=i}}forwardBegin(){this.forwardFlug=!0,this.forwardAnimation&&this.forwardAnimation.play()}forwardEnd(){this.forwardFlug=!1,this.forwardAnimation&&this.forwardAnimation.stop()}turnUpdate(e=1*Math.PI/180){if(this.turnDirection!==b.None){const t=this.turnDirection===b.Right;let o=this.vrm.scene.rotation.y+(t?-e:e);o>2*Math.PI&&(o-=2*Math.PI),this.vrm.scene.rotation.y=o}}turnBegin(e){if("string"!==typeof e)this.turnDirection=e;else switch(e){case"right":this.turnDirection=b.Right;break;case"left":this.turnDirection=b.Left;break}}turnEnd(){this.turnDirection=b.None}}var H=JSON.parse('{"chest":{"rotation":[0,0,0,1]},"head":{"rotation":[0,0,0,1]},"hips":{"rotation":[0,0,0,1]},"leftEye":{"rotation":[-0.004140808689857954,0.0000026381149985140594,1.0924023164401745e-8,0.9999914268114674]},"leftFoot":{"rotation":[0,0,0,1]},"leftHand":{"rotation":[0,0,0,1]},"leftIndexDistal":{"rotation":[0,0,0,1]},"leftIndexIntermediate":{"rotation":[0,0,0,1]},"leftIndexProximal":{"rotation":[0,0,0,1]},"leftLittleDistal":{"rotation":[0,0,0,1]},"leftLittleIntermediate":{"rotation":[0,0,0,1]},"leftLittleProximal":{"rotation":[0,0,0,1]},"leftLowerArm":{"rotation":[0,0,0.02220097471628269,0.9997535279865968]},"leftLowerLeg":{"rotation":[0,0,0,1]},"leftMiddleDistal":{"rotation":[0,0,0,1]},"leftMiddleIntermediate":{"rotation":[0,0,0,1]},"leftMiddleProximal":{"rotation":[0,0,0,1]},"leftRingDistal":{"rotation":[0,0,0,1]},"leftRingIntermediate":{"rotation":[0,0,0,1]},"leftRingProximal":{"rotation":[0,0,0,1]},"leftShoulder":{"rotation":[0,0,0,1]},"leftThumbDistal":{"rotation":[0,0,0,1]},"leftThumbIntermediate":{"rotation":[0,0,0,1]},"leftThumbProximal":{"rotation":[0,0,0,1]},"leftToes":{"rotation":[0,0,0,1]},"leftUpperArm":{"rotation":[-0.02677661194738245,0.000006930879917677393,0.595572391993285,0.8028552415597588]},"leftUpperLeg":{"rotation":[0,0,0,1]},"neck":{"rotation":[0,0,0,1]},"rightEye":{"rotation":[-0.004140808689865959,0.0000017587433323438395,7.282682109605855e-9,0.9999914268134006]},"rightFoot":{"rotation":[0,0,0,1]},"rightHand":{"rotation":[0,0,0,1]},"rightIndexDistal":{"rotation":[0,0,0,1]},"rightIndexIntermediate":{"rotation":[0,0,0,1]},"rightIndexProximal":{"rotation":[0,0,0,1]},"rightLittleDistal":{"rotation":[0,0,0,1]},"rightLittleIntermediate":{"rotation":[0,0,0,1]},"rightLittleProximal":{"rotation":[0,0,0,1]},"rightLowerArm":{"rotation":[0,0,-0.02221565939508331,0.9997532017841412]},"rightLowerLeg":{"rotation":[0,0,0,1]},"rightMiddleDistal":{"rotation":[0,0,0,1]},"rightMiddleIntermediate":{"rotation":[0,0,0,1]},"rightMiddleProximal":{"rotation":[0,0,0,1]},"rightRingDistal":{"rotation":[0,0,0,1]},"rightRingIntermediate":{"rotation":[0,0,0,1]},"rightRingProximal":{"rotation":[0,0,0,1]},"rightShoulder":{"rotation":[0,0,0,1]},"rightThumbDistal":{"rotation":[0,0,0,1]},"rightThumbIntermediate":{"rotation":[0,0,0,1]},"rightThumbProximal":{"rotation":[0,0,0,1]},"rightToes":{"rotation":[0,0,0,1]},"rightUpperArm":{"rotation":[-0.026928574954714804,-0.000005788262645524747,-0.5998397628937062,0.7996668748103967]},"rightUpperLeg":{"rotation":[0,0,0,1]},"spine":{"rotation":[0,0,0,1]},"upperChest":{"rotation":[0,0,0,1]}}'),N=o(7993),B=o.n(N),P=o(5941);function R(e,t,o){const i=new c.q;i.scale.setScalar(45e4),e.add(i);const n=new s.Pa4,r={turbidity:10,rayleigh:3,mieCoefficient:.005,mieDirectionalG:.7,elevation:2,azimuth:180,exposure:t.toneMappingExposure};function a(){const a=i.material.uniforms;a.turbidity.value=r.turbidity,a.rayleigh.value=r.rayleigh,a.mieCoefficient.value=r.mieCoefficient,a.mieDirectionalG.value=r.mieDirectionalG;const d=s.M8C.degToRad(90-r.elevation),m=s.M8C.degToRad(r.azimuth);n.setFromSphericalCoords(1,d,m),a.sunPosition.value.copy(n),t.toneMappingExposure=r.exposure,t.render(e,o)}const d=new u.XS;d.add(r,"turbidity",0,20,.1).onChange(a),d.add(r,"rayleigh",0,4,.001).onChange(a),d.add(r,"mieCoefficient",0,.1,.001).onChange(a),d.add(r,"mieDirectionalG",0,1,.001).onChange(a),d.add(r,"elevation",0,90,.1).onChange(a),d.add(r,"azimuth",-180,180,.1).onChange(a),d.add(r,"exposure",0,1,1e-4).onChange(a),a()}const k=(0,n.aZ)({async setup(){const e=new s.CP7;e.setSize(window.innerWidth,window.innerHeight),e.setPixelRatio(window.devicePixelRatio),document.body.appendChild(e.domElement);const t=new s.cPb(30,window.innerWidth/window.innerHeight,.1,20);t.position.set(0,1,4);const o=new l.z(t,e.domElement);o.screenSpacePanning=!0,o.target.set(0,1,0),o.update();const i=new s.xsS,n=new s.Ox3(16777215);n.position.set(1,1,1).normalize(),i.add(n),R(i,e,t);const r=new d.E;r.crossOrigin="anonymous";const a=await r.loadAsync(h());m.ck.removeUnnecessaryVertices(a.scene),m.ck.removeUnnecessaryJoints(a.scene);const c=await m.n4.from(a);i.add(c.scene),c.scene.rotation.y+=Math.PI;const u=c;c.humanoid.getBoneNode(m.wZ.HumanoidBoneName.Hips).rotation.y=Math.PI,c.springBoneManager.reset(),c.humanoid.setPose(H);const f=new s.SUY,p=new g.y,w=await p.loadAsync(B());P.log(w);const v=y(w.animations[0],c,!1);P.log(v),v.name="walk";const x=new s.Xcj(c.scene),b=x.clipAction(v).setEffectiveWeight(1);b.clampWhenFinished=!0;const L=new A(c,b);let N=(new Date).getTime();function k(){requestAnimationFrame(k);const o=f.getDelta();if(u){u.update(o),L.forwardUpdate(),L.turnUpdate();const n=Math.sin(Math.PI*f.elapsedTime);P.log(n),u.blendShapeProxy.setValue(m.wZ.BlendShapePresetName.Joy,.5+.5*n);const r=(new Date).getTime();x&&x.update(r-N),N=r,e.setAnimationLoop((()=>{e.render(i,t)})),x&&x.update(f.getDelta())}window.addEventListener("keyup",(e=>{switch(e.code){case"ArrowUp":case"KeyW":L.forwardEnd();break;case"ArrowLeft":case"KeyA":case"ArrowRight":case"KeyD":L.turnEnd();break}})),window.addEventListener("keydown",(e=>{switch(e.code){case"ArrowUp":case"KeyW":L.forwardBegin();break;case"ArrowLeft":case"KeyA":L.turnBegin("left");break;case"ArrowRight":case"KeyD":L.turnBegin("right");break}})),e.render(i,t)}k()}});(0,i.ri)(k).mount("#app")}},t={};function o(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,i,n,r){if(!i){var a=1/0;for(l=0;l<e.length;l++){i=e[l][0],n=e[l][1],r=e[l][2];for(var s=!0,d=0;d<i.length;d++)(!1&r||a>=r)&&Object.keys(o.O).every((function(e){return o.O[e](i[d])}))?i.splice(d--,1):(s=!1,r<a&&(a=r));if(s){e.splice(l--,1);var m=n();void 0!==m&&(t=m)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[i,n,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/"}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,r,a=i[0],s=i[1],d=i[2],m=0;if(a.some((function(t){return 0!==e[t]}))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(d)var l=d(o)}for(t&&t(i);m<a.length;m++)r=a[m],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(l)},i=self["webpackChunkextendable_viewer"]=self["webpackChunkextendable_viewer"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=o.O(void 0,[998],(function(){return o(8768)}));i=o.O(i)})();
//# sourceMappingURL=app.a9b594a9.js.map